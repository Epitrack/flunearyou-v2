var APP=APP||{};APP.Status={setUp:function(){var handlerStatus;handlerStatus=APP.delegate(this,this.getStatus),$(window).on("online offline",handlerStatus)},getStatus:function(){var that=this;1==navigator.onLine?that.statusOn():that.statusOff()},statusOn:function(){var body;body=document.querySelector("body"),body.classList.remove("js-offline"),body.removeAttribute("data-status"),APP.Storage.searchToSend()},statusOff:function(){var body;body=document.querySelector("body"),body.classList.add("js-offline"),body.setAttribute("data-status","Você parece não possuir acesso a internet :(")}};var APP=APP||{};APP.Cache={setUp:function(){this.handlerUpdate()},handlerUpdate:function(){var that,appCache;that=this,appCache=window.applicationCache,appCache.addEventListener("cached",that.handleCachedEvent,!1),appCache.addEventListener("checking",that.handleCacheChecking,!1),appCache.addEventListener("downloading",that.handleCacheDownloading,!1),appCache.addEventListener("error",that.handleCacheError,!1),appCache.addEventListener("noupdate",that.handleCacheNoupdate,!1),appCache.addEventListener("obsolete",that.handleCacheObsolete,!1),appCache.addEventListener("progress",that.handleCacheProgress,!1),appCache.addEventListener("updateready",that.handleCacheUpdateready,!1)},handleCachedEvent:function(){console.log(event)},handleCacheChecking:function(){console.log(event)},handleCacheDownloading:function(){console.log(event)},handleCacheError:function(){console.warn(error)},handleCacheNoupdate:function(){console.log(event)},handleCacheObsolete:function(){console.log(event)},handleCacheProgress:function(){console.log(event)},handleCacheUpdateready:function(){var appCache=window.applicationCache;appCache.swapCache(),confirm("Existe uma nova versão para este site, deseja atualizar?")&&window.location.reload()}};var APP=APP||{};APP.Language={setUp:function(){this.startLanguage(),this.changeLanguage()},startLanguage:function(){i18n.init({fallbackLng:"en-US",debug:!1,fixLng:!0,load:"current"},function(translation){var appName,string;$("[data-i18n]").i18n(),appName=translation("app.name"),string=document.cookie,-1!=string.indexOf("i18next=pt-BR")?(APP.Language.i18pt(),$(".pt").addClass("js-active")):(APP.Language.i18en(),$(".en").addClass("js-active"))})},i18en:function(){i18n.setLng("en-US",{fixLng:!0},function(translation){$("[data-i18n]").i18n()}),$("#logo-primary").removeClass("js-logo-pt"),$("#logo-primary").addClass("js-logo-en"),$(".nav-logo").css("background-image","url(dist/images/logo-primary-2-en.png)"),$(".navbar-brand").css("background-image","url(dist/images/logo-primary-2-en.png)")},i18pt:function(){i18n.setLng("pt-BR",{fixLng:!0},function(translation){$("[data-i18n]").i18n()}),$("#logo-primary").removeClass("js-logo-en"),$("#logo-primary").addClass("js-logo-pt"),$(".nav-logo").css("background-image","url(dist/images/logo-primary-2-pt.png)"),$(".navbar-brand").css("background-image","url(dist/images/logo-primary-2-pt.png)")},activeClass:function(element){$("#switch-language button").removeClass("js-active"),$(element).addClass("js-active")},changeLanguage:function(){var attr,element;$("#switch-language").on("click","button",function(event){element=this,attr=$(this).attr("data-language"),"en"==attr?(APP.Language.activeClass(element),APP.Language.i18en()):"pt"==attr&&(APP.Language.activeClass(element),APP.Language.i18pt())})},i18n:function(){}};var APP=APP||{};APP.Scroll={setUp:function(){},getClick:function(){var target,that;that=this,$(".nav-list").on("click","a",function(event){event.preventDefault(),target=$($(this).attr("href")),that.smoothScroll(target,85)})},smoothScroll:function(target,offset){$("html, body").animate({scrollTop:target.offset().top-offset},1500)},getPosition:function(){$(window).on("scroll",function(){$(document).scrollTop()>=345?$("#nav-primary").addClass("js-nav-active"):$(document).scrollTop()<=405&&$("#nav-primary").removeClass("js-nav-active")})}};var APP=APP||{};APP.Contact={setUp:function(){this.submitForm()},submitForm:function(){var formdata,that,email;that=this,$("#contact-form").on("submit",function(event){event.preventDefault(),formdata=$("#contact-form").serialize(),email=$("#contact-email").val(),that.checkStatus(email,formdata)})},checkStatus:function(email,formdata){var that=this;0==$("body").hasClass("js-offline")?that.sendForm(formdata):APP.Storage.insertLocalStorage(email,formdata)},sendForm:function(formdata){$.ajax({url:"send.php",type:"POST",data:formdata,beforeSend:function(){console.log("Sending...")},success:function(data){console.log(data)},error:function(error){console.warn(error)}})}};var APP=APP||{};APP.Modal={setUp:function(){},modal:function(){$(".modal").fancybox({maxWidth:800,maxHeight:600,fitToView:!1,width:"70%",height:"70%",autoSize:!1,closeClick:!1,openEffect:"elastic",closeEffect:"fade"})},lightbox:function(){$(".lightbox").fancybox({prevEffect:"fade",nextEffect:"fade",closeBtn:!0,index:2,helpers:{title:{type:"inside"},buttons:{}}})}};var APP=APP||{};APP.EasterEggs={setUp:function(){this.checkPlatform()},checkPlatform:function(){var mobile,regex,that;that=this,regex=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,mobile=regex.test(navigator.userAgent),mobile||that.activeWithText()},activeWithText:function(){cheet("h u m a n s",function(){window.open(document.URL+"humans.txt","Project Team")})}};var APP=APP||{};APP.Calendar={setUp:function(){},fny:function(){function c(){p();var e=h(),r=0,u=!1;for(l.empty();!u;)s[r]==e[0].weekday?u=!0:(l.append('<div class="blank"></div>'),r++);for(var c=0;42-r>c;c++)if(c>=e.length)l.append('<div class="blank"></div>');else{var v=e[c].day,m=g(new Date(t,n-1,v))?'<div class="today">':"<div>";l.append(m+""+v+"</div>")}o[n-1];a.find("h1").text(i[n-1]+" "+t),d()}function h(){for(var e=[],r=1;r<v(t,n)+1;r++)e.push({day:r,weekday:s[m(t,n,r)]});return e}function p(){f.empty();for(var e=0;7>e;e++)f.append("<div>"+s[e].substring(0,3)+"</div>")}function d(){var t,n=$("#calendar").css("width",e+"px");n.find(t="#calendar_weekdays, #calendar_content").css("width",e+"px").find("div").css({width:e/7+"px",height:e/7+"px","line-height":e/7+"px"}),n.find("#calendar_header").css({height:e*(1/7)+"px"}).find('i[class^="icon-chevron"]').css("line-height",e*(1/7)+"px")}function v(e,t){return new Date(e,t,0).getDate()}function m(e,t,n){return new Date(e,t-1,n).getDay()}function g(e){return y(new Date)==y(e)}function y(e){return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()}function b(){var e=new Date;t=e.getFullYear(),n=e.getMonth()+1}if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i))var e=320;else var e=480;var t=10,n=9,i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=["#16a085","#1abc9c","#c0392b","#27ae60","#FF6860","#f39c12","#f1c40f","#e67e22","#2ecc71","#e74c3c","#d35400","#2c3e50"],u=$("#calendar"),a=u.find("#calendar_header"),f=u.find("#calendar_weekdays"),l=u.find("#calendar_content");b(),c(),a.find('i[class^="icon-chevron"]').on("click",function(){var e=$(this),r=function(e){n="next"==e?n+1:n-1,1>n?(n=12,t--):n>12&&(n=1,t++),c()};r(-1!=e.attr("class").indexOf("left")?"previous":"next")})}};var APP=APP||{};APP.Faq={setUp:function(){this.beforeRequest(),this.filterFaq()},beforeRequest:function(){var that,faqStorage;that=this,faqStorage=localStorage.getItem("faq-storage"),faqStorage?that.templateOff(faqStorage):that.request()},request:function(){var url,that,faqFeeds,htmlElement,body;that=this,url="http://dev.flunearyou.org/faq.json",htmlElement=document.querySelector("#questions"),body=document.querySelector("body"),$.ajax({url:url,type:"GET",beforeSend:function(){body.classList.add("js-loading")},success:function(data){body.classList.remove("js-loading"),faqFeeds=data.data,200===data.status?(that.template(faqFeeds),that.insertIntoStorage(faqFeeds)):htmlElement.innerHTML=faqFeeds},error:function(error){console.warn("Request error:",error),htmlElement.innerHTML=error}})},templateOff:function(faqStorage){var that;that=this,that.template(JSON.parse(faqStorage))},template:function(faqFeeds){var source,template,output,faqList,ask,answer,id;source=document.getElementById("faq-template").innerHTML,template=Handlebars.compile(source),faqList=[];for(var i=0;i<faqFeeds.length;i++)id=faqFeeds[i].id_faq,ask=faqFeeds[i].ask,answer=faqFeeds[i].answer,faqList.push({id:id,ask:ask,answer:answer}),output=template({faq:faqList}),document.getElementById("questions").innerHTML=output},insertIntoStorage:function(faqFeeds){localStorage.setItem("faq-storage",JSON.stringify(faqFeeds))},filterFaq:function(){var resultsItem;$("#search-term").on("keyup",function(){var search=$(this).val(),count=0;$("#questions li").each(function(){$(this).text().search(new RegExp(search,"i"))<0?$(this).fadeOut():($(this).show(),count++)}),resultsItem=count,$("#count-results").text(resultsItem)})}};var APP=APP||{};APP.FluNews={setUp:function(){this.request()},request:function(){},storage:function(){}};var APP=APP||{};APP.Login={setUp:function(){},fny:function(){var endpoint="user/login";$("#login-submit").click(function(e){$("#password").rules("add",{required:!0})}),$("#forgot-pw").click(function(e){e.preventDefault(),endpoint="user/reset_password",$("#password").rules("remove"),$("#login-form").submit()}),$("#login-form").validate({ignore:"",rules:{email:{validEmail:!0},password:"required"},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter(element)},invalidHandler:function(event,validator){$(".modal-login").addClass("js-form-error"),setTimeout(function(){$(".modal-login").removeClass("js-form-error")},1e3),$(validator.lastActive).focus().toggleClass("js-input-error")},submitHandler:function(){var formData=$("#login-form").serializeObject(),query=jQuery.param(formData);$("#login-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:endpoint,headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#login-submit").prop("disabled",!1),$("#login-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_login),$("#login-error").show()},success:function(data){$("#login-submit").prop("disabled",!1),200==data.status?($("#login-error").hide(),"user/reset_password"==endpoint?($("#login-status-message").text(app.passwordRecoveryText),$("#login-status").show()):(toastr.success(data.message+i18nJS_redirecting),close_modal(),redirectUser(data.info.basic.current_survey,data.info.basic.token))):($("#login-error-message").text(data.message),$("#login-error").show()),endpoint="user/login"}})}}),$("#facebook-login").on("click",function(){"undefined"!=typeof FB&&($("#facebook-login").prop("disabled",!0),FB.login(function(response){if("connected"===response.status){var token=response.authResponse.accessToken;blockUI(i18nJS_processing),$.ajax({url:"user/login/facebook",headers:{"auth-token":1},data:{access_token:token},type:"post",success:function(result){200==result.status?($("#login-error").hide(),toastr.success(result.message+"Redirecting..."),close_modal(),redirectUser(result.info.basic.current_survey,result.info.basic.token)):toastr.warning(data.message)},error:function(data,XMLHttpRequest,textStatus,errorThrown){toastr.warning(data.message),$("#google-plus-login").prop("disabled",!1)}}).retry({times:3})}else alert("not_authorized"===response.status?"Please authorize Facebook - and try again!":"Unknown error occurred - please try again.")},{scope:"email"}))}),$("#google-plus-login").on("click",function(){function loginCallback(authResult){authResult.status.signed_in?(token=authResult.access_token,blockUI(i18nJS_processing),$.ajax({url:"user/login/googleplus",headers:{"auth-token":1},data:{access_token:token},type:"post",success:function(result){200==result.status?($("#login-error").hide(),toastr.success(result.message+"Redirecting..."),close_modal(),redirectUser(result.info.basic.current_survey,result.info.basic.token)):toastr.warning(data.message)},error:function(data,XMLHttpRequest,textStatus,errorThrown){toastr.warning(data.message),$("#google-plus-login").prop("disabled",!1)}}).retry({times:3})):console.log("Sign-in state: "+authResult.error)}$("#google-plus-login").prop("disabled",!0);var additionalParams={callback:loginCallback,scope:"https://www.googleapis.com/auth/plus.profile.emails.read",response_type:"code"};gapi.auth.signIn(additionalParams)})}};var APP=APP||{};APP.Main={setUp:function(){},fny:function(){function show_cdc_data(e){0==cdc_data?($("#illness-options").hide(),$("#illness").fadeIn(),cdc_data=1):($("#illness").hide(),$("#illness-options").fadeIn(),cdc_data=0)}function open_map_responsive(e){0==map_home?($(".map").show(),$("#overlay_data").show(),$(document.body).addClass("home-show-map"),$(".view-map").addClass("hide-data"),$(".view-map").html("HIDE MAP"),$(".wrapper-statics").hide(),map_home=1,null!=e&&null==app.map&&abreMapa(!1)):($(".map").hide(),$("#overlay_data").hide(),$(document.body).removeClass("home-show-map"),$(".view-map").removeClass("hide-data"),$(".view-map").html("VIEW MAP"),$(".wrapper-statics").show(),map_home=0)}function open_data(e){0==data_home?($("#illness, .wrapper-show-desease-near-me").show(),$(".view-data").addClass("hide-data"),$(".view-data").html("HIDE DATA"),data_home=1):($("#illness, .wrapper-show-desease-near-me").hide(),$(".view-data").removeClass("hide-data"),$(".view-data").html("SHOW DATA"),data_home=0)}function open_active_accordion(e){the_id=e.currentTarget.id,prop_checked=$("#"+the_id).prop("checked"),prop_checked?($(".item_accordion input").prop("checked",!1),$(".item_accordion input").removeClass("active_servicio"),$("#"+the_id).parent().addClass("active_servicio"),$("#"+the_id).prop("checked",!0)):$("#"+the_id).parent().removeClass("active_servicio")}function open_active_accordion(e){the_id=e.currentTarget.id,prop_checked=$("#"+the_id).prop("checked"),prop_checked?($(".item_accordion input").prop("checked",!1),$(".item_accordion input").removeClass("active_servicio"),$("#"+the_id).parent().addClass("active_servicio"),$("#"+the_id).prop("checked",!0)):$("#"+the_id).parent().removeClass("active_servicio")}function open_login_modal(e){e.preventDefault(),close_modal(),$("#modal-login").modal("show"),$(".main-menu-button").hide()}function open_signup_modal(e){e.preventDefault(),close_modal(),$("#modal-login").modal("hide"),$(".main-menu-button").hide()}function open_survey_modal1(e){e.preventDefault(),close_modal(),$("#modal-survey-step1").modal("show")}function open_survey_modal2(e){e.preventDefault(),close_modal(),$("#modal-survey-step2").modal("show")}function open_survey_modal3(e){e.preventDefault(),close_modal(),$("#modal-survey-step3").modal("show")}function open_survey_modal5(e){e.preventDefault(),close_modal(),$("#modal-survey-step5").modal("show")}function close_modal(){$("#modal-survey-step1").modal("hide"),$("#modal-survey-step2").modal("hide"),$("#modal-survey-step3").modal("hide"),$("#modal-survey-step4").modal("hide"),$("#modal-survey-step5").modal("hide"),$("#modal-registration").modal("hide"),$("#illness").css("zIndex","999"),$(".modal-list").show(),$(".modal-right-div h4").show(),$(".modal-right-div h3").show(),$("#facebook-register").show(),$("#google-plus-register").show(),$(".btn-register").show(),$(".text-separator").show(),$(".open_form").show(),$("#registration-form").hide(),$(".main-menu-button").show()}function abreMapa(center){null==app.map&&($("#navbar-map").addClass("active"),app.openMap(center))}function open_previous(e){$(window).width()<="480"&&($(".wrapper-items-symptoms").css("top","165px"),$(".wrapper-items-previous").css("height","194px"),$(".wrapper-items-previous").css("top","0"),$(".wrapper-items-symptoms").css("height","29px"),$(".wrapper-items-previous").css("padding-top","29px"),$(".close-section-sym").css("transform","rotate(45deg)"),$(".close-section-prev").css("transform","rotate(0deg)"),$(".open-previous").addClass("close-prev"),$(".close-prev").on("click",function(){$(".open-previous").removeClass("close-prev"),$(this).off("click"),$(".wrapper-items-previous").css("height","29px"),$(".wrapper-items-previous").css("position","relative"),$(".wrapper-items-previous").css("top","0px"),$(".wrapper-items-previous").css("padding-top","0px"),$(".wrapper-items-symptoms").css("top","0px"),$(".close-section-prev").css("transform","rotate(45deg)"),$(".open-symptoms").on("click",open_symptoms),$(".open-previous").on("click",open_previous),$("open-symptoms").removeClass("close-sym")}))}function open_symptoms(e){$(window).width()<="480"&&($(".wrapper-items-symptoms").css("height","120px"),$(".wrapper-items-symptoms").css("top","0px"),$(".wrapper-items-previous").css("height","29px"),$(".wrapper-items-previous").css("position","relative"),$(".wrapper-items-previous").css("top","91px"),$(".wrapper-items-previous").css("padding-top","0px"),$(".close-section-sym").css("transform","rotate(0deg)"),$(".close-section-prev").css("transform","rotate(45deg)"),$(".open-symptoms").addClass("close-sym"),$(".close-sym").on("click",function(e){$(this).off("click"),$("open-symptoms").removeClass("close-sym"),$(".wrapper-items-symptoms").css("height","29px"),$(".close-section-sym").css("transform","rotate(45deg)"),$(".wrapper-items-previous").css("top","0px"),$(".open-previous").on("click",open_previous),$(".open-symptoms").on("click",open_symptoms),$(".open-previous").removeClass("close-prev")}))}function smoothScroll(target,offset){console.log("target",target);var k=target.offset().top-offset;$("html, body").animate({scrollTop:k},k/1e3*1e3)}function checkModal(){$("body").hasClass("modal-open")?($("#illness").css("zIndex","9999"),$("#navbar-primary").css("zIndex","999")):($("#illness").css("zIndex","999"),$("#navbar-primary").css("zIndex","9999"))}function checkUrl(href,network){if("twitter"==network){url="https://twitter.com/home?status="+href;var left=Number(screen.width/2-200),tops=Number(screen.height/2-125);window.open(url,"gplus","width=600,height=250, left="+left+",top="+tops)}else if("facebook"==network)FB.ui({method:"share",href:href},function(response){});else if("google"==network){url="https://plus.google.com/share?url="+href;var left=Number(screen.width/2-300),tops=Number(screen.height/2-200);window.open(url,"gplus","width=600,height=400, left="+left+",top="+tops)}}var map_home=0,cdc_data=0;$(".hide-data").on("click",function(e){$("view-data").removeClass("hide-data"),$("view-data").html("SHOW DATA")}),data_home=0,$(".item_accordion input").on("click",function(e){the_id=e.currentTarget.id,$(".item_accordion input").parent().removeClass("active_servicio"),$("#"+the_id).parent().addClass("active_servicio")}),$(".item_accordion input").prop("checked",!1),$(".item_accordion > input").on("click",open_active_accordion),description=0,$(".down_description_count").on("click",function(e){0==description?($(".description_symptoms_item").css("max-height","200px"),description=1):($(".description_symptoms_item").css("max-height","0px"),description=0)}),$(".item_accordion input").on("click",function(e){the_id=e.currentTarget.id,$(".item_accordion input").parent().removeClass("active_servicio"),$("#"+the_id).parent().addClass("active_servicio")}),$(".item_accordion input").prop("checked",!1),$(".item_accordion > input").on("click",open_active_accordion),$("#flu-map").click(function(e){e.preventDefault(),map_home=0,open_map_responsive(null),$("#navbar-about").removeClass("active"),null==app.map&&abreMapa(!0)}),$("#form_zip").submit(function(e){e.preventDefault(),map_home=0,open_map_responsive(null),null==app.map?abreMapa(!0):app.centerOnZip()}),$("#state_viewtype_flu").on("click",function(){$("#cdc-statics").show(),$("#user-statics").hide(),map.setView("cdc")}),$(".button-cta").on("click",function(){$(".main-menu-button").hide()}),$("#state_viewtype_user").on("click",function(){map.setView("user")}),$(".hide-illness").on("click",function(){$("#illness").fadeOut(),$(".show-illness").fadeIn(),$(".hide-illness").hide(),$(".wrapper_button_hide_show_illness").css("left","0")}),$(".show-illness").on("click",function(){$("#illness").fadeIn(),$(".show-illness").fadeOut(),$(".hide-illness").fadeIn(),$(".wrapper_button_hide_show_illness").css("left","330px"),$(window).width()<="480"&&$(".wrapper_button_hide_show_illness").css("left","32px")}),$(".open-previous").on("click",open_previous),$(".open-symptoms").on("click",open_symptoms),$("#open-form").on("click",function(event){event.preventDefault(),$(".show-modal-registration").slideDown(),$("#modal-registration").css({display:"block",overflow:"hidden",height:"564px"}),$(".modal .modal-right-div").css({overflow:"scroll !important",height:"426px"}),$(".open-form").css("margin","10px 0 40px 0"),$(this).css({transition:"all 2000ms",position:"relative",top:"1em"}),$(".modal-registration").animate({scrollTop:$("#registration-form").offset().top},2e3)}),$(document).on("keyup",function(event){27==event.keyCode&&(checkModal(),close_modal())}),$(".go-to").on("click",function(event){event.preventDefault();var target=$(this).attr("href");console.log("target",target),setTimeout(function(){smoothScroll($(target),150)},10)}),$(document).on("click",function(){checkModal()}),$("#navbar-primary").sticky({topSpacing:0,className:"js-active",wrapperClassName:"wrapper-navbar-primary"}),$("#navbar-primary").css({height:"100px",opacity:"1"}),$("#navbar-primary").on("sticky-start",function(){$("#navbar-primary").css("height","60px")}),$("#navbar-primary").on("sticky-end",function(event){$("#navbar-primary").css("height","110px")}),$(".close-buton-login, .no-thanks a").on("click",function(event){event.preventDefault(),close_modal()}),$(".share-social").on("click","a",function(event){event.preventDefault();var href;href=$(this).attr("data-href"),network=$(this).attr("id"),checkUrl(href,network),$("body").removeClass("modal-open"),$(".modal-backdrop ").removeClass("modal-backdrop"),$("#modal-social").attr("aria-hidden","true"),$("#modal-social").removeClass("in"),$("#modal-social").css("display","none")}),$("#accordion").on("click","h3",function(){$("#accordion h3").removeClass(),$(this).addClass("js-active")}),$(".item-help").on("mouseover",function(e){the_id=e.currentTarget.id,$("#"+the_id+" .wrapper-social-networks-help").show()}),$(".item-help").on("mouseout",function(e){the_id=e.currentTarget.id,$(".wrapper-social-networks-help").hide()}),$(".hidestep2").on("click",function(e){e.preventDefault(),$(".span-title-survey").hide(),$(".survey-2-step").hide(),$(".survey-3-step").fadeIn()}),$(".hidestep3").on("click",function(e){e.preventDefault(),$(".survey-3-step, .span-title-survey").hide(),$(".survey-4-step").fadeIn()}),$(".tab-help:first").addClass("current-tab"),$("#content-tab-two").hide(),$(".item-tab").on("click","a",function(event){event.preventDefault();var href=$(this).attr("href");$(".item-tab a").removeClass("current-tab"),$(this).addClass("current-tab"),$(".content-tab-item").hide(),$(href).fadeIn()}),$("#not-symptoms").on("click",function(e){1==$(this).prop("checked")&&($('.survey-group .wrapper-checkbox input[type="checkbox"]').prop("checked",!1),$(".survey-range-calendar-wrapper").hide(),$(".wrapper-temperatura-fever").hide())}),$("#modal-sign-up").on("click",open_survey_modal1),$("#modal-to-step2").on("click",open_survey_modal2),$("#modal-to-step3").on("click",open_survey_modal3),$("#modal-to-step5").on("click",open_survey_modal5),$(".go-login").on("click",open_login_modal),$(".go-signup").on("click",open_signup_modal),$(".view-data").on("click",open_data),$(".view-map").on("click",open_map_responsive),$(".sintoma").change(function(){$(this).is(":checked")&&$("#no-sintomas").prop("checked",!1)}),$("#fiebre").change(function(){$(this).is(":checked")?($("#fever_f").val("N"),$("#no-sintomas").prop("checked",!1),$(".wrapper-temperatura-fever").show()):$(".wrapper-temperatura-fever").hide(),$("#textbox1").val($(this).is(":checked"))}),$(".show-cdc-data").on("click",show_cdc_data),$(document).ajaxStop($.unblockUI),jQuery.fn.selectOptionWithText=function(targetText){return this.each(function(){var $selectElement,$options,$targetOption;$selectElement=jQuery(this),$options=$selectElement.find("option"),$targetOption=$options.filter(function(){return jQuery(this).text()==targetText}),$targetOption.prop?$targetOption.prop("selected",!0):$targetOption.attr("selected","true")})}}};var APP=APP||{};APP.Map={setUp:function(){},fny:function(){function Map(){this.init=function(latitude,longitude,zoom,center){$(".view-map").addClass("hide-data"),$(".view-map").html("HIDE MAP"),map_home=1;var self=this;this.overlay="user",this.userMarkers=[],this.setView=function(overlay,in_center){self.overlay=overlay,"user"==overlay?(self.clearDataLayer(),self.clearMarkers(self.map),self.userMarkers.length>0?(self.setUserMarkers(self.map),in_center?app.centerOnZip():app.pendingCenter?(console.log("pendingCenter"),centerMap(app.pendingCenter[0],app.pendingCenter[1],app.pendingCenter[2]),app.pendingCenter=null):(console.log("zoomForUserMarkers"),setTimeout(function(){$.unblockUI(),self.geolocate(self.map)},1e3),self.zoomForUserMarkers())):setTimeout(self.setView,1e3,overlay,in_center),$("#legend-cdc").hide(),$("#legend-user").show(),$("#cdc-statics").hide(),$("#user-statics").show()):(blockUI(i18nJS_loading_cdc_data),null!=self.stateBounds?(self.clearDataLayer(),self.clearMarkers(self.map),self.map.map.data.setStyle(self.styleCDCOverlays),self.map.map.data.addGeoJson(JSON.parse(self.stateBounds),{idPropertyName:"id"}),self.zoomForCDCOverlay(self.map.map),self.map.map.data.addListener("click",function(e){var name=e.feature.getProperty("name");if(app.cdc_level){var cdc=JSON.parse(app.cdc_level);cdc[name]?($("#where").selectOptionWithText(name),updateSummary({contained_by:$("#where").val()})):$("#map_bg").css("background","#fff6cc")}}),setTimeout(function(){$.unblockUI()},200)):(self.clearDataLayer(),self.getStateBounds(function(){self.setView("cdc")}),self.clearMarkers(self.map)),$(".wrapper-statics").show(),$("#legend-cdc").show(),$("#legend-user").hide())},this.clearDataLayer=function(){self.map.map.data.setMap(null),self.map.map.data=new google.maps.Data({map:self.map.map}),self.map.map.data.setMap(self.map.map)},this.setInfobox=function(marker){var content='<div class="infobox"><h3 class="infobox-title"> Reports in: '+marker.city+"</h3>";return site_name==SALUD_BORICUA?("dengue"==illness&&(content+='<div class="infobox-description"> <p class="value"> '+marker.dengue+' </p> <p class="text"> Dengue </p> </div>'),"lepto"==illness&&(content+='<div class="infobox-description"> <p class="value"> '+marker.lepto+' </p> <p class="text"> Lepto </p> </div>'),"chick"==illness&&(content+='<div class="infobox-description"> <p class="value"> '+marker.chick+' </p> <p class="text"> Chikungunya </p> </div>'),"ili"==illness&&(content+='<div class="infobox-description"> <p class="value"> '+marker.flu+' </p> <p class="text"> Gripe </p> </div>')):content+='<div class="infobox-description"> <p class="value"> '+marker.flu+' </p> <p class="text"> Flu symptoms </p> </div>',content+='<div class="infobox-description"> <p class="value"> '+marker.symptoms+' </p> <p class="text"> Any symptoms </p> </div>',content+='<div class="infobox-description"> <p class="value"> '+marker.none+' </p> <p class="text"> No<br/> symptoms </p> </div>',content+="</div>"},this.geolocate=function(map){GMaps.geolocate({success:function(position){GMaps.geocode({lat:position.coords.latitude,lng:position.coords.longitude,callback:function(results,status){if("OK"==status){var country=getAddressComponent("country",results[0],!0);if(site_name==SALUD_BORICUA&&"PR"==country||"flunearyou.org"==site_name&&"US"==country){map.setCenter(position.coords.latitude,position.coords.longitude);var zip=getAddressComponent("postal_code",results[0],!0),latlng=results[0].geometry.location;self.map.setCenter(latlng.lat(),latlng.lng()),self.map.setZoom(7),app.updateUserMarker(position.coords.latitude,position.coords.longitude),updateSummary({zip:zip})}else console.log("geolocate else"),site_name==SALUD_BORICUA?(self.map.setCenter(app.latitude,app.longitude),self.map.setZoom(9),updateSummary({contained_by:192})):(self.map.setCenter(app.latitude,-101),self.map.setZoom(4),updateSummary({contained_by:106}))}}})},error:function(error){},not_supported:function(){},always:function(){}})},this.setCustomMarker=function(lat,lng,map){var image="img/map/marker.png",customMarker={lat:lat,lng:lng,icon:image,title:"Me",zIndex:1e3,animation:google.maps.Animation.DROP};return customMarker},this.createUserMakers=function(markers){var pins=new Array;site_name==SALUD_BORICUA?pins[1]="img/icon-symptoms-4.png":pins[1]="img/icon-symptoms-2.png",pins[3]="img/icon-symptoms-3.png",pins[5]="img/icon-symptoms-1.png";for(var i=0;i<markers.length;i++){var marker=markers[i],html=this.setInfobox(marker);if(marker.latitude&&marker.longitude){var markerIcon=marker.icon;5==markerIcon&&("ili"==illness?markerIcon=marker.flu>0?5:3:"dengue"==illness?markerIcon=marker.dengue>0?5:3:"chick"==illness?markerIcon=marker.chick>0?5:3:"lepto"==illness&&(markerIcon=marker.lepto>0?5:3));var m={lat:marker.latitude,lng:marker.longitude,title:marker.city,zip:marker.zip,place_id:marker.place_id,location:{lat:marker.latitude,lng:marker.longitude,place_id:marker.place_id,contained_by:marker.contained_by},icon:pins[markerIcon],infoWindow:{content:html,maxWidth:410,zIndex:null,boxStyle:{width:"410px",background:"orange",closeBoxMargin:"12px 4px 2px 2px"}},click:function(e){e.location&&(ga("send","event","Map","Clicked Marker",e.title),site_name!=SALUD_BORICUA&&updateSummary(e.location),self.map.setCenter(e.location.lat,e.location.lng))}};5==marker.icon?m.zIndex=999:3==marker.icon&&(m.zIndex=700),this.userMarkers.push(m)}}},this.setUserMarkers=function(map){for(var i=0;i<self.userMarkers.length;i++){var marker=self.userMarkers[i];map.addMarker(marker)}},this.clearMarkers=function(map){map.removeMarkers()},this.mapStyle=[{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#CDE7F6"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#326E95"},{weight:1.1}]},{featureType:"administrative.province",elementType:"labels.text.fill",stylers:[{color:"#326E95"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#006196"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#7DBCDB"}]},{featureType:"administrative",elementType:"labels.icon",stylers:[{color:"#ffffff"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#013750"}]}],this.map=new GMaps({div:"#banner-map",lat:latitude,lng:longitude,zoom:parseInt(zoom),panControl:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,disableDefaultUI:!0,navigationControl:!0,scrollwheel:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_CENTER},streetViewControl:!1,mapTypeId:"Styled",mapTypeId:google.maps.MapTypeId.ROADMAP}),this.map.addStyle({styledMapName:"Styled",styles:this.mapStyle,mapTypeId:"Styled"}),this.map.setStyle("Styled"),this.getMarkers=function(scope,in_center){blockUI(i18nJS_loading_reports);$.ajax({url:"map/markers",headers:{"auth-token":1},type:"get",error:function(){},success:function(data){scope.rawMarkers=data,scope.createUserMakers(scope.rawMarkers),scope.setView("user",in_center)}})},this.getStateBounds=function(cb){$.ajax({url:"assets/states.geo.json",success:function(data){self.stateBounds=data,self.getCDCData(self,cb)}})},this.processPoints=function(geometry,callback,thisArg){
geometry instanceof google.maps.LatLng?callback.call(thisArg,geometry):geometry instanceof google.maps.Data.Point?callback.call(thisArg,geometry.get()):geometry.getArray().forEach(function(g){self.processPoints(g,callback,thisArg)})},this.styleCDCOverlays=function(feature){var color,dataCDC=self.dataCDC,name=feature.getProperty("name");return color=dataCDC[name]?dataCDC[name].fill.color:"#FFFFFF",{fillColor:color,fillOpacity:.85,strokeWeight:1}},this.zoomForUserMarkers=function(){site_name!=SALUD_BORICUA?(self.map.setCenter(app.latitude,-101),self.map.setZoom(4)):(console.log("zoom for user markers"),self.map.setCenter(app.latitude,app.longitude),self.map.setZoom(6))},this.zoomForCDCOverlay=function(map){self.clearMarkers(self.map),map.setZoom(4),self.map.setCenter(app.latitude,-101),app.p0&&self.map.addMarker(app.p0)},this.getMarkers(this,center)},this.getCDCData=function(scope,cb){$.ajax({url:"map/cdc",error:function(){self.getCDCData(scope,cb)},success:function(data){scope.dataCDC=data,cb()}})}}var map,app=app||{};app.openMap=function(geo){if(map)geo?app.centerOnZip():app.map.geolocate(map.map);else{$("#cdc-statics").hide(),map=app.map=new Map;var latitude=app.latitude,zoom=(app.longitude,4);app.map.init(latitude,-101,zoom,geo)}},app.centerOnZip=function(){if($("#zip").val()||app.user.zip){var zip=null!=$("#zip").val()?$("#zip").val():app.user.zip;null!=zip&&(zip+=site_name==SALUD_BORICUA?", PR":", US"),GMaps.geocode({address:zip,callback:function(results,status){if($.unblockUI(),"OK"==status){var country=getAddressComponent("country",results[0],!0),zip=getAddressComponent("postal_code",results[0],!0);if(console.log("centerOnZip",country,zip),site_name==SALUD_BORICUA)if("PR"==country){var latlng=results[0].geometry.location;map.map.setCenter(latlng.lat(),latlng.lng()),app.updateUserMarker(latlng.lat(),latlng.lng(),!1),map.map.setZoom(9),updateSummary({zip:zip})}else console.log("centerOnZip : else",app.latitude,app.longitude),centerMap(192,app.latitude,app.longitude),map.map.setZoom(9),updateSummary({contained_by:192});else{console.log("centerOnZip : else 475");var latlng=results[0].geometry.location;map.map.setCenter(latlng.lat(),latlng.lng()),map.map.setZoom(10),updateSummary({zip:zip,name:results[0].address_components[0].long_name}),setTimeout(function(){app.openInfoBoxByZip(zip)},1e3),app.updateUserMarker(latlng.lat(),latlng.lng(),!1)}}}})}else map.geolocate(map.map)},app.openInfoBoxByZip=function(zip){if(zip){var markers=map.map.markers,m2=$.grep(markers,function(e){return e.zip==zip||e.title.indexOf(zip)>=0});app.infoWindow&&app.infoWindow.close(),m2.length>0&&(app.infoWindow=m2[0].infoWindow,app.infoWindow.open(map.map.map,m2[0]))}},app.openInfoBoxByName=function(name){var markers=map.map.markers,m=$.grep(markers,function(e){return e.title.toLowerCase().indexOf(name.toLowerCase())>-1});m.length>0&&m[0].infoWindow.open(map.map.map,m[0])},app.openInfoBoxByPlaceId=function(place_id){var markers=map.map.markers,m=$.grep(markers,function(e){return e.place_id==place_id});m.length>0&&m[0].infoWindow.open(map.map.map,m[0])},app.findClosestMarker=function(lat1,lon1,t){t||(t=150);var i,markers=map.map.markers,pi=Math.PI,R=6371,distances=[],closest=-1,mlength=markers.length;if(mlength>3){for(i=0;mlength>i;i++){var marker=markers[i];if(null!=marker&&null!=marker.infoWindow){var lat2=markers[i].position.lat(),lon2=markers[i].position.lng(),latDiffInRadians=lat2-lat1,lngDiffInRadians=lon2-lon1,latDiff=latDiffInRadians*(pi/180),lngDiff=lngDiffInRadians*(pi/180),latRadius=lat1*(pi/180),lngRadius=lat2*(pi/180),a=Math.sin(latDiff/2)*Math.sin(latDiff/2)+Math.sin(lngDiff/2)*Math.sin(lngDiff/2)*Math.cos(latRadius)*Math.cos(lngRadius),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c;distances[i]=d,(-1==closest||d<distances[closest])&&(closest=i)}}if(closest>0){var dCLosest=distances[closest];return t>dCLosest?markers[closest]:null}return null}return null},app.updateUserMarker=function(lat,lng,d){if(app.p0||(app.p0=app.map.map.addMarker(app.map.setCustomMarker(app.latitude,app.longitude,app.map.map))),app.p0){var latlng=new google.maps.LatLng(lat,lng);app.p0.setPosition(latlng),d&&setTimeout(function(){app.openClosestInfoWindow(lat,lng)},2e3)}},app.openClosestInfoWindow=function(lat,lng,t){var m=app.findClosestMarker(lat,lng,t);m?(app.infoWindow&&app.infoWindow.close(),app.infoWindow=m.infoWindow,app.infoWindow.open(map.map.map,m)):(app.infoWindow&&app.infoWindow.close(),app.infoWindow=null)}}};var APP=APP||{};APP.Mobile={setUp:function(){this.changePlatform(),this.checkMobileAds(),this.clickContinue()},changePlatform:function(){navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?document.body.classList.add("to-iphone"):navigator.userAgent.match(/Android/i)&&document.body.classList.add("to-android")},checkMobileAds:function(){var record,that;that=this,record=sessionStorage.getItem("hideMobileAds"),null==record||"false"==record?that.showMobileAds():that.hideMobileAds()},hideMobileAds:function(){$(".content-mobile").hide(),sessionStorage.setItem("hideMobileAds","true")},showMobileAds:function(){$(".content-mobile").show(),sessionStorage.setItem("hideMobileAds","false")},clickContinue:function(){var that;that=this,$(".continue").on("click",function(){$("body").removeClass(),that.hideMobileAds()})}};var APP=APP||{};APP.Press={setUp:function(){this.trigger()},request:function(){},storage:function(){},trigger:function(){var that,href;that=this,$(".press-share").on("click","a",function(event){event.preventDefault(),href=this.href,network=$(this).attr("class"),that.checkUrl(href,network)})},checkUrl:function(href,network){"twitter"==network?(url="https://twitter.com/home?status="+href,window.open(url)):"facebook"==network?(url="https://www.facebook.com/sharer/sharer.php?u="+href,window.open(url)):"gplus"==network&&(url="https://plus.google.com/share?url="+href,window.open(url))}};var APP=APP||{};APP.Settings={setUp:function(){},fny:function(){$("#bt-edit").click(function(e){$("#bt-edit").addClass("hidden"),$("#update-user-form .user_form_field").removeClass("hidden"),$("#update-user-form .user_form_label").addClass("hidden")}),$(document).ready(function(){$(".btn-report").click(function(e){var uhid=$(e.currentTarget).data("uhid");uhid&&(window.location.href="survey?user_household_id="+uhid),e.stopImmediatePropagation()}),$(".btn-edit").click(function(e){var uhid=$(e.currentTarget).data("uhid"),dob=$(e.currentTarget).data("dob"),gender=$(e.currentTarget).data("gender"),nickname=$(e.currentTarget).data("nickname"),month=dob.split("/")[0],year=dob.split("/")[1];bootbox.dialog({title:"Edit Household Member",message:'<div class="row">  <div class="col-md-12"> <form class="form-horizontal edit_household_member" id="edit_household_member"> <input name="user_household_id" id="user_household_id" type="hidden" value='+uhid+'><div class="form-group"> <label class="col-md-4 control-label" for="name">'+i18nJS_hh_nickname+'</label> <div class="col-md-4"> <input id="edit_household_name" name="nickname" type="text" class="form-control input-md" value="'+nickname+'"></div> </div> <div class="form-group"> <label class="col-md-4 control-label" for="gender">'+i18nJS_hh_gender+'</label> <div class="col-md-4"> <div class="radio"> <label for="male"> <input type="radio" name="gender" value="M"> '+i18nJS_hh_male+'</label> </div><div class="radio"> <label for="female"> <input type="radio" name="gender" id="female" value="F"> '+i18nJS_hh_female+'</label> </div> </div> </div><label class="col-md-4 control-label" for="birthdate">'+i18nJS_hh_bday+'</label> <div class="col-md-7 nopadding"><div class="col-md-5 nopadding"><label for="" class="select month edit_household" id="edit_birthmonth"><select class="survey-birthmonth" name="birthmonth" id="edit_household_month" required><option value="0">'+i18nJS_hh_month+'</option><option value="1">'+i18nJS_hh_jan+'</option><option value="2">'+i18nJS_hh_feb+'</option><option value="3">'+i18nJS_hh_mar+'</option><option value="4">'+i18nJS_hh_apr+'</option><option value="5">'+i18nJS_hh_may+'</option><option value="6">'+i18nJS_hh_jun+'</option><option value="7">'+i18nJS_hh_jul+'</option><option value="8">'+i18nJS_hh_aug+'</option><option value="9">'+i18nJS_hh_sep+'</option><option value="10">'+i18nJS_hh_oct+'</option><option value="11">'+i18nJS_hh_nov+'</option><option value="12">'+i18nJS_hh_dez+'</option></select></label></div><div class="col-md-5 nopadding"><input class="survey-birthyear" type="tel" name="birthyear" id="edit_household_birthyear" value="'+year+'" required></div></div></div></form> </div>  <div id="edit-error" class="alert alert-danger" style="display: none;margin-top: 30px;margin-bottom: 0" role="alert"><span id="edit-error-message"></span></div></div>',buttons:{main:{label:i18nJS_hh_save,id:"edit-submit",className:"btn-success",callback:function(e){return $("#edit_household_member").submit(),!1}}}}),$("#edit_household_member select").val(month),$("input[name=gender][value="+gender+"]").prop("checked",!0),$("#edit_household_member").validate({rules:{birthmonth:{required:!0,min:1,number:!0},nickname:{maxlength:20},birthyear:{isAlive:!0},gender:"required"},messages:{nickname:{maxlength:i18nJS_hh_large_nick}},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter("gender"==element[0].name?element.parent().parent():element)},invalidHandler:function(event,validator){$("#edit-error-message").text(i18nJS_error_form),$("#edit-error").show()},submitHandler:function(){var formData=$("#edit_household_member").serializeObject(),query=jQuery.param(formData);console.log("query",query),$("#edit-error").hide(),$("#edit-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user/household/update",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#update-submit").prop("disabled",!1),$("#edit-error-message").text(data.responseJSON?i18nTxt(data.message,data.message_es):i18nJS_error_user),$("#edit-error").show()},success:function(data){$("#update-submit").prop("disabled",!1),200==data.status?($("#edit_household_member")[0].reset(),toastr.success(i18nTxt(data.message,data.message_es)),bootbox.hideAll(),window.location.reload()):($("#edit-error-message").text(i18nTxt(data.message,data.message_es)),$("#edit-error").show())}})}}),e.stopImmediatePropagation()}),$(".btn-deactivate").click(function(e){var uhid=$(e.currentTarget).data("uhid");bootbox.confirm(deactivate_message,function(result){result&&(blockUI("..."),$.ajax({url:"user/household/deactivate",headers:{"auth-token":1},data:{user_household_id:uhid},type:"post",success:function(data){window.location.reload()}}))}),e.stopImmediatePropagation()}),$(".btn-activate").click(function(e){var uhid=$(e.currentTarget).data("uhid");bootbox.confirm(activate_message,function(result){result&&(blockUI("..."),$.ajax({url:"user/household/activate",headers:{"auth-token":1},data:{user_household_id:uhid},type:"post",success:function(data){window.location.href="reports"}}))}),e.stopImmediatePropagation()}),$("#accordion .in").collapse("hide"),$(".name").addClass("collapsed"),$("#member_reports").fadeIn(1)}),$("#update-user-form").validate({rules:{email:{validEmail:!0},birthmonth:"required",birthyear:{oldEnough:!0},gender:"required",zip:"required"},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter(element.parent())},invalidHandler:function(event,validator){$("#update-error-message").text(i18nJS_error_form),$("#update-error").show()},submitHandler:function(){var formData=$("#update-user-form").serializeObject(),query=jQuery.param(formData);$("#update-error").hide(),$("#update-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user/update",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#update-submit").prop("disabled",!1),$("#update-error-message").text(data.responseJSON?data.message:i18nJS_error_user),$("#update-error").show()},success:function(data){$("#update-submit").prop("disabled",!1),200==data.status?($("#update-user-form")[0].reset(),$("#update-user-form .user_form_field").addClass("hidden"),$("#update-user-form .user_form_label").removeClass("hidden"),$("#bt-edit").removeClass("hidden"),toastr.success(data.message),window.location.reload()):($("#update-error-message").text(data.message),$("#update-error").show())}})}}),$("#change-password-form").validate({ignore:"",rules:{old_password:"required",password:"required",confirm_password:{required:!0,equalTo:"#password"}},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertBefore(element.parent())},invalidHandler:function(event,validator){$("#password-error-message").text(i18nJS_error_form),$("#password-error").show()},submitHandler:function(){var formData=$("#change-password-form").serializeObject(),query=jQuery.param(formData);$("#password-error").hide(),$("#password-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user/update/password",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#password-submit").prop("disabled",!1),$("#password-error-message").text(data.message?data.message:i18nJS_error_password),$("#password-error").show()},success:function(data){$("#password-submit").prop("disabled",!1),200==data.status?($("#change-password-form")[0].reset(),toastr.success(data.message)):($("#password-error-message").text(data.message),$("#password-error").show())}})}}),$("#add-household-form").validate({ignore:"",rules:{nickname:{maxlength:30},birthmonth:"required",birthyear:{isAlive:!0,digits:!0},gender:"required"},messages:{nickname:{maxlength:"This Nickname is too large"}},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter("nickname"==element[0].name?element:"year"==element[0].name?element:element.parent())},invalidHandler:function(event,validator){$("#household-error-message").text(i18nJS_error_form),$("#household-error").show()},submitHandler:function(){var formData=$("#add-household-form").serializeObject(),query=jQuery.param(formData);$("#household-error").hide(),$("#survey-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user/household",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#survey-submit").prop("disabled",!1),$("#household-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_member),$("#household-error").show()},success:function(data){200==data.status?(toastr.success(i18nTxt(data.message,data.message_es)),$("#add-household-form")[0].reset(),window.location.reload()):($("#household-error-message").text(data.responseJSON.message),$("#household-error").show())}})}}),$("#add_household_member").hide(),$("#change-password").hide(),$("#add-member").on("click",function(){$("#add_household_member").slideDown()}),$("#close-household-form").on("click",function(e){e.preventDefault(),$("#add_household_member").hide()}),$("#close-password-form").on("click",function(e){e.preventDefault(),$("#change-password").hide()}),$(".submit-change-password").on("click",function(e){e.preventDefault(),$("#change-password").slideDown()})}};var APP=APP||{};APP.Signup={setUp:function(){},fny:function(){$("#registration-form").validate({ignore:"",rules:{email:{validEmail:!0},birthmonth:{required:!0,notEqual:0},birthyear:{oldEnough:!0,isAlive:!0},gender:"required"},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter("gender"==element[0].name?$("#label_woman"):element)},invalidHandler:function(event,validator){$("#registration-error-message").text(i18nJS_error_form),$("#registration-error").show()},submitHandler:function(){var formData=$("#registration-form").serializeObject(),query=jQuery.param(formData);"1"==app.ncmrc&&(query.ncmrc=app.ncmrc),$("#registration-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#registration-submit").prop("disabled",!1),$("#registration-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_account),$("#registration-error").show()},success:function(data){data.token&&$.ajax({type:"GET",url:"//api.nanigans.com/event.php?app_id=157283&s2s=1&type=install&name=emailsubmit&nan_pid="+data.token+"&user_id="+data.token}),$("#registration-submit").prop("disabled",!1),200==data.status?($("#registration-error").hide(),toastr.success(data.message),blockUI(i18nJS_redirecting),setTimeout(function(){window.location.href="survey"},500)):($("#registration-error-message").text(data.message),$("#registration-error").show())}})}})}};var APP=APP||{};APP.Signup=APP.Signup||{},APP.Signup.Facebook={setUp:function(){},fny:function(){var token;$("#facebook-register").on("click",function(){"undefined"!=typeof FB&&($("#facebook-register").prop("disabled",!0),FB.login(function(response){"connected"===response.status?($(".modal-zip").css("zIndex","9"),$(".modal-zip").css("opacity","1"),$(".card").addClass("flipped"),$("#bt-zip").on("click",function(event){var retorno=$("#input-modal-zip").val();console.log("submit",retorno),$("card").removeClass("flipped"),$(".modal-zip").css("zIndex","-1"),$(".modal-zip").css("opacity","0"),blockUI(i18nJS_processing),token=response.authResponse.accessToken;var query={access_token:token,zip:retorno,platform:"web"};"1"==app.ncmrc&&(query.ncmrc=app.ncmrc),$.ajax({url:"user/facebook",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#registration-error-message").text(data.message),$("#registration-error").show(),$("#facebook-register").prop("disabled",!1)},success:function(data){"existing"==data.user_status?redirectUser(data.info.basic.current_survey,data.info.basic.token):"pending"==data.user_status?(data.token&&$.ajax({type:"GET",url:"//api.nanigans.com/event.php?app_id=157283&s2s=1&type=install&name=emailsubmit&nan_pid="+data.token+"&user_id="+data.token}),close_modal(),bootbox.dialog({message:app.registration_next_step,title:app.thanks_for_reg,buttons:{success:{label:"Ok!",className:"btn-success"}}})):($("#registration-error-message").text(data.message),$("#registration-error").show(),$("#facebook-register").prop("disabled",!1))}}).retry({times:3})})):alert("not_authorized"===response.status?"Please authorize Facebook - and try again!":"Unknown error occurred - please try again.")},{scope:"email, user_birthday, user_location"}))})}};var APP=APP||{};APP.Signup=APP.Signup||{},APP.Signup.GooglePlus={setUp:function(){},fny:function(){function signinCallback(authResult){if(authResult.status.signed_in){console.log(authResult);var token;$(".modal-zip").css("zIndex","9"),$(".modal-zip").css("opacity","1"),$(".card").addClass("flipped"),$("#bt-zip").on("click",function(event){var retorno=$("#input-modal-zip").val();console.log("submit",retorno),$("card").removeClass("flipped"),$(".modal-zip").css("zIndex","-1"),$(".modal-zip").css("opacity","0"),blockUI(i18nJS_processing),token=authResult.access_token;var query={access_token:token,zip:retorno,platform:"web"};"1"==app.ncmrc&&(query.ncmrc=app.ncmrc),$.ajax({url:"user/googleplus",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){toastr.warning(data.message),$("#google-plus-register").prop("disabled",!1)},success:function(data){"existing"==data.user_status?redirectUser(data.info.basic.current_survey,data.info.basic.token):"pending"==data.user_status?(data.token&&$.ajax({type:"GET",url:"//api.nanigans.com/event.php?app_id=157283&s2s=1&type=install&name=emailsubmit&nan_pid="+data.token+"&user_id="+data.token}),close_modal(),bootbox.dialog({message:app.registration_next_step,title:app.thanks_for_reg,buttons:{success:{label:"Ok!",className:"btn-success"}}})):(toastr.warning(data.message),$("#google-plus-register").prop("disabled",!1))}}).retry({times:3})})}else console.log("Sign-in state: "+authResult.error)}$("#google-plus-register").on("click",function(){var additionalParams={callback:signinCallback,scope:"https://www.googleapis.com/auth/plus.profile.emails.read",response_type:"code"};gapi.auth.signIn(additionalParams)})}};var APP=APP||{};APP.Summary={setUp:function(){},fny:function(){function updateSummary(params){if(site_name==SALUD_BORICUA)params.contained_by&&getSummaryByPlaceId(params.contained_by,function(data){summary=data,updateDatabox(summary)});else if(params.contained_by&&hasContainedBy(params.contained_by)){$("#where").val(params.contained_by),$("#where").selectpicker("render"),192==params.contained_by?$("#map-icon").attr("src","img/img-mapa-data.png"):106==params.contained_by?$("#map-icon").attr("src","img/map-us.png"):12==params.contained_by?$("#map-icon").attr("src","img/map-can.png"):$("#map-icon").attr("src","img/map/states/"+$("#where").find(":selected").text().replace(" ","-").replace(",","")+".png"),summary=getSummaryByPlace(params.contained_by),getLinks(params.contained_by);var lat=$("#where").find(":selected").data("lat"),lon=$("#where").find(":selected").data("lon");$("#map_bg").data("lat",lat),$("#map_bg").data("lon",lon)}else params.zip?getSummaryByZip(params.zip,function(data){data.contained_by&&($("#where").val(data.contained_by),updateSummary({contained_by:data.contained_by}))}):params.name&&getSummaryByName(params.name,function(data){data.contained_by&&106!=data.contained_by?($("#where").val(data.contained_by),updateSummary({contained_by:data.contained_by})):data.place_id&&($("#where").val(data.place_id),updateSummary({contained_by:data.place_id}))});summary&&updateDatabox(summary)}function updateDatabox(summary){var illness_count=summary.data[illness],illness_count_lw=summary.last_week_data[illness],illness_percentage=summary.data[illness+"_percentage"];$("#illness_count_span").removeClass("arrow-down").removeClass("arrow-up"),illness_count>illness_count_lw?($("#illness_count_span").addClass("arrow-up"),$("#summary_tip").text(more_than_last_week.replace("%disease%"," "+illness_name.toLowerCase()))):($("#illness_count_span").addClass("arrow-down"),$("#summary_tip").text(less_than_last_week.replace("%disease%"," "+illness_name.toLowerCase()))),site_name==SALUD_BORICUA&&$("#where").text("en Puerto Rico");var any_count=summary.data.symptoms,any_pct=summary.data.symptoms_percentage,no_count=summary.data.no_symptoms,no_pct=summary.data.none_percentage,colors=["#FFFFFF","#54B410","#6DEA11","#76EA0B","#A6EB17","#D1ED1F","#E9D225","#E69C27","#DE6926","#D83526","#B82121"],imgs=["","icon-dbox-minimal1.png","icon-dbox-minimal2.png","icon-dbox-minimal3.png","icon-dbox-low1.png","icon-dbox-low2.png","icon-dbox-moderate1.png","icon-dbox-moderate2.png","icon-dbox-high1.png","icon-dbox-high2.png","icon-dbox-high3.png"];site_name==SALUD_BORICUA&&$(".illness_label").text(illness_name),$("#summary_participants").text(summary.data.total_surveys),$("#illness_count").text(illness_count),$("#illness_reports").text(illness_count),$("#illness_percentage, .illness_percentage").text(Math.round(illness_percentage)+"%"),$("#any_count").text(any_count),$("#any_pct").text(Math.round(any_pct)+"%"),$("#no_count").text(no_count),$("#no_pct").text(Math.round(no_pct)+"%");var cdc=JSON.parse(app.cdc_level);if(cdc[summary.name]&&site_name!=SALUD_BORICUA){var level=Math.floor(parseInt(cdc[summary.name].level2));$("#map_bg").css("background",colors[level]),$("#mini_pin").attr("src","img/"+imgs[level])}else $("#map_bg").css("background",colors[summary.data.level]),$("#mini_pin").attr("src","img/"+imgs[summary.data.level]);$("#illness_name").text(illness)}function getSummaryByName(name,cb){$.ajax({url:"map_summary",method:"get",data:{name:name},success:function(data){cb(data)}}).retry({times:3})}function getSummaryByZip(zip,cb){$.ajax({url:"map_summary",method:"get",data:{zip:zip},success:function(data){cb(data)}}).retry({times:3})}function getSummaryByPlaceId(place_id,cb){$.ajax({url:"map_summary",method:"get",data:{place_id:place_id},success:function(data){cb(data)}}).retry({times:3})}function hasContainedBy(contained_by){var r=!1;return $("#where option").each(function(){var v=parseInt($(this).val())==parseInt(contained_by);v&&(r||(r=!0))}),r}function centerMap(val,lat,lon){null!=map.map&&app.map.userMarkers.length?106==val||39.96693==lat&&site_name!=SALUD_BORICUA?(map.map.setCenter(app.latitude,-101),map.map.setZoom(4)):(map.map.setCenter(lat,lon),map.map.setZoom(site_name==SALUD_BORICUA?9:6)):(lat||(lat=app.latitude),lon||(lon=app.longitude),app.pendingCenter=[val,lat,lon])}function getSummaryByPlace(place_id){for(var states=JSON.parse(app.states),i=0;i<states.length;i++)if(states[i].place_id==place_id)return states[i];return null}function getLinks(place_id){$.ajax({url:"site/links?place_id="+place_id,headers:{"auth-token":1},type:"get",error:function(){},success:function(data){$("#local_links").empty();for(var i=0;i<data.links.length;i++)$("#local_links").append("<li><a href="+data.links[i].website+' target="_blank">'+data.links[i].title+"</a></li>")}})}var illness="ili",summary=summary||null;$("#illness-list").change(function(){illness=$(this).find(":selected").val(),illness_name=$(this).find(":selected").text(),app.map&&(app.map.clearMarkers(app.map.map),app.map.userMarkers=[],app.map.createUserMakers(app.map.rawMarkers),app.map.setUserMarkers(app.map.map)),summary&&updateDatabox(summary)}),$("#where").change(function(){var lat=$(this).find(":selected").data("lat"),lon=$(this).find(":selected").data("lon"),val=$(this).find(":selected").val();map?centerMap(val,lat,lon):(map_home=0,open_map_responsive(null),abreMapa(!1),centerMap(val,lat,lon)),$("#zip").val(""),updateSummary({contained_by:$(this).find(":selected").val()}),$("#map_bg").data("lat",lat),$("#map_bg").data("lon",lon)}),$("#map_bg").on("click",function(){var lat=$(this).data("lat"),lon=$(this).data("lon");map_home=0,open_map_responsive(null),null==app.map?(abreMapa(!1),centerMap(0,lat,lon)):centerMap(0,lat,lon)})}};var APP=APP||{};APP.Survey={setUp:function(){},fny:function(){$(function(){function plus(){var a=$("#thermometer_slider").slider("value");$("#thermometer_slider").slider("value",++a)}function minus(){var a=$("#thermometer_slider").slider("value");$("#thermometer_slider").slider("value",--a)}var week_of=moment(app.week_of,"YYYY-MM-DD"),next_week_of=moment(app.next_week_of,"YYYY-MM-DD"),endpoint="survey";$("#survey-submit").on("click",function(e){}),$("#bt-process-reminder").click(function(){var remindMe=$('input[name="remind_me"]:checked').val();2==remindMe?(blockUI("..."),$.ajax({url:"user/reminder/enable",headers:{"auth-token":1},type:"post",success:function(result){toastr.success(result.message),window.location.href="home?thanks=1"}}).retry({times:3})):0==remindMe?(blockUI("..."),$.ajax({url:"user/reminder/disable",headers:{"auth-token":1},type:"post",success:function(result){toastr.success(result.message),window.location.href="home?thanks=1"}}).retry({times:3})):1==remindMe?($(".span-title-survey").hide(),$(".survey-2-step").hide(),$(".survey-3-step").fadeIn()):window.location.href="home?thanks=1"}),$("#survey-form").validate({ignore:"",rules:{flu_vaccine:{required:!0,vaccineQuestion:!0},flu_vaccine_lastyr:{required:!0},no_symptoms:{symptomsReporting:!0}},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter(element.parent().parent())},invalidHandler:function(event,validator){$("#survey-error-message").text(i18nJS_error_form),$("#survey-error").show()},submitHandler:function(){$("#survey-error").hide();var formData=$("#survey-form").serializeObject();null!=formData.date&&delete formData.date,null!=formData.date_submit&&delete formData.date_submit,""==formData.ill_date&&delete formData.ill_date,""==formData.fever_f&&delete formData.fever_f,-1==formData.user_household_id?(formData.user_household_id=0,endpoint="survey/all"):0==formData.user_household_id&&(endpoint="survey");var query=jQuery.param(formData);$("#survey-submit").prop("disabled",!0),blockUI("Sending Survey"),$.ajax({url:endpoint,headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#survey-submit").prop("disabled",!1),$("#survey-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_survey),$("#survey-error").show()},success:function(data){var nanigans_value=1,unique=(new Date).getTime();if(0==weeks_reported)var nanigans_url="https://api.nanigans.com/event.php?app_id=157283&s2s=1&type=purchase&name=firstsurveysubmit&user_id="+user_id+"&value[0]="+nanigans_value+"&unique="+unique;else var nanigans_url="https://api.nanigans.com/event.php?app_id=157283&s2s=1&type=purchase&name=secondsurveysubmit&user_id="+user_id+"&value[0]="+nanigans_value+"&unique="+unique;if($.ajax({type:"GET",url:nanigans_url}),200==data.status){var pm=data.pending_members;pm||(pm=pending_members),pm?window.location.href="survey?user_household_id="+pm:(toastr.success(data.message),hasHousehold||"N"==moreMembers?window.location.href="home?thanks=1":($(".survey-1-step").hide(),$(".survey-2-step").fadeIn()))}else $("#survey-error-message").text(data.responseJSON.message),$("#survey-error").show()}})}}),$("#add-household-form").validate({ignore:"",rules:{nickname:{maxlength:20},birthmonth:"required",birthyear:{isAlive:!0,digits:!0},gender:"required"},messages:{nickname:{maxlength:"This Nickname is too large"}},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter(element.parent())},invalidHandler:function(event,validator){$("#household-error-message").text(i18nJS_error_form),$("#household-error").show()},submitHandler:function(){var formData=$("#add-household-form").serializeObject(),query=jQuery.param(formData);$("#household-error").hide(),$("#survey-submit").prop("disabled",!0),blockUI(i18nJS_adding_member),$.ajax({url:"user/household",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#survey-submit").prop("disabled",!1),$("#household-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_member),$("#household-error").show()},success:function(data){200==data.status?(toastr.success(data.message),$("#add-household-form")[0].reset(),getHouseholdMembers("members-table")):($("#household-error-message").text(data.responseJSON.message),$("#household-error").show())}})}}),$(document).ready(function(){$(document).ajaxStop($.unblockUI),$("#thermometer_bg").width(0);var user_household_id=location.search.split("user_household_id=")[1];if(user_household_id){var option=$("#household").find('option[value="'+user_household_id+'"]');option.attr("selected",!0)}}),$("#not-symptoms").on("change",function(){$("#conditional").toggleClass("disabled"),$("#conditional").hasClass("disabled")?($("#temperature,#datepicker").hide(),$("#conditional input").attr("disabled",!0),$(".symptom").attr("checked",!1),$("#fever_f").val("")):($("#fever_f").val(""),$("#conditional input").attr("disabled",!1))});var v=0,slide=function(event,ui){var l,left=$(".ui-slider-handle").position().left;if(l=ui.value>v?$(".ui-slider-handle").position().left:$(".ui-slider-handle").position().left,console.log("positivo","ui.value: ",ui.value,"l: ",l,"left: ",left,"v: ",v),$("#thermometer_bg").width(l),v=ui.value,ui.value>1){var n=(99.7+ui.value/10).toFixed(1);n>=101?($("#text-slider").html(i18nJS_greater_than+n+" ºF"),$("#fever_f").val(101),$("#thermometer_bg").addClass("hight")):99.9==n?($("#text-slider").html(i18nJS_less_than+99.9+" ºF"),$("#fever_f").val(99.9),$("#thermometer_bg").removeClass()):($("#text-slider").html(n+" ºF"),$("#fever_f").val(n),$("#thermometer_bg").removeClass())}else $("#text-slider").html("")};$("#text-slider").html(""),$("#thermometer_slider").slider({range:!1,min:1,max:13,step:1,
animate:!1,value:1,slide:slide,change:slide}),$("#button-thermometer-plus").on("click",function(){plus()}),$("#button-thermometer-minus").on("click",function(){minus()}),$("#conditional").on("click","input, label",function(){$("#datepicker").show(),0==$(".symptom:checked").length&&$("#datepicker").hide()}),$("#calendar_content").on("click",".js-week",function(){$("#calendar_content").find("div").removeClass("today"),$(this).addClass("today")}),$("#calendar_header").on("click","i",function(){$(".blank").remove()}),$("#temperature").hide(),$("#not_measured").on("change",function(){1==$("#not_measured:checked").length?($("#thermometer").hide(),$("#text-slider").hide(),$("#button-thermometer-minus").hide(),$("#button-thermometer-plus").hide(),$("#fever_f").val("")):($("#thermometer").show(),$("#text-slider").show(),$("#button-thermometer-minus").show(),$("#button-thermometer-plus").show())}),$("#fever").on("change",function(){1==$("#fever:checked").length?($("#temperature").show(),$("#thermometer_slider").slider("value",2)):$("#temperature").hide()}),$("#datepicker").hide(),$(document).on("ready",function(){var k=week_of.clone();$("#date_input").pickadate({min:k.day(-6).toDate(),max:next_week_of.toDate(),format:"dddd, mmmm d yyyy",onSet:function(context){$("#ill_date").val(moment(context.select).format("YYYY-MM-DD"))}});var picker=$("#date_input").pickadate("picker");picker.set("select",week_of.toDate()),$("#ill_date").val(null),$("#date_input").val(null),$(".blank").remove(),$(".finalizar-continuar").click(function(){blockUI("Redirecting"),setTimeout(function(){window.location.href="survey"},2e3)})})})}};var APP=APP||{};APP.Tracking={setUp:function(){},fny:function(){$("[data-track]").on("click",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action"),label=$(this).attr("data-label");ga("send","event",category,action,label)}),$("#where").on("change",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action"),label=$("#where option:selected").text();ga("send","event",category,action,label)}),$("#symptoms-item-count").on("click",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action"),label=$(this).attr("data-label");ga("send","event",category,action,label)}),$("#postal-code-submit").on("click",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action"),label=$("#zip").val();ga("send","event",category,action,label)}),$("#registration-form").on("submit",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action"),label=$(this).attr("data-label");ga("send","event",category,action,label)}),$("#survey-form").on("submit",function(){var category=$(this).attr("data-track"),action=$(this).attr("data-action");ga("send","event",category,action)})}};var APP=APP||{};APP.Unsubscribe={setUp:function(){},fny:function(){$(function(){$("#unsub-form").validate({ignore:"",rules:{pauseoption:"required",reason:"required"},errorClass:"survey-error",errorElement:"div",errorPlacement:function(error,element){error.insertAfter(element)},invalidHandler:function(event,validator){$(validator.lastActive).focus().toggleClass("js-input-error")},submitHandler:function(){var formData=$("#unsub-form").serializeObject(),query=jQuery.param(formData);$("#unsub-submit").prop("disabled",!0),blockUI(i18nJS_processing),$.ajax({url:"user/unsubscribe",headers:{"auth-token":1},data:query,type:"post",error:function(data,XMLHttpRequest,textStatus,errorThrown){$("#unsub-submit").prop("disabled",!1),$("#unsub-error-message").text(data.responseJSON?data.responseJSON.message:i18nJS_error_unsubscribe),$("#unsub-error").show()},success:function(data){$("#unsub-submit").prop("disabled",!1),200==data.status?($("#unsub-error").hide(),toastr.success(data.message),window.location.href="home"):($("#unsub-error-message").text(data.message),$("#unsub-error").show())}})}})})}};var APP=APP||{};APP.VaccineFinder={setUp:function(){},fny:function(){$("#vaccine-finder-btn").click(function(){return window.open("http://flushot.healthmap.org/?address="+$("#vaccine-finder-input").val()),!1})}};var APP=APP||{};APP.Validation={setUp:function(){},fny:function(){$.validator.addMethod("isAlive",function(value,element,params){var age=parseInt(moment().diff(new Date(value,1,1),"years"));return console.log("age",age),2016>value&&age>=0&&90>age},i18nJS_invalid_bday),$.validator.addMethod("oldEnough",function(value,element,params){var age=parseInt(moment().diff(new Date(value,1,1),"years"));return console.log("age",age),age>=13},i18nJS_minimum13),$.validator.addMethod("validEmail",function(value,element,params){var pattern=new RegExp(/^(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return pattern.test(value)},app.form_validation_email),jQuery.validator.addMethod("notEqual",function(value,element,param){return this.optional(element)||value!=param},i18nJS_select_birthmonth),$.validator.addMethod("validZip",function(value,element,params){var pattern=new RegExp(/(^\d{5}$)|(^[ABCEGHJKLMNPRSTVXYabceghjklmnprstvxy]{1}\d{1}[A-Za-z]{1} *\d{1}[A-Za-z]{1}\d{1}$)/);return pattern.test(value)},i18nJS_valid_postal_code),$.validator.addMethod("symptomsReporting",function(){return $("input:checkbox:checked.sintoma").length<1&&$("input:checkbox:checked.no_symptoms").length<1?!1:!0},i18nJS_report_symptoms),$.validator.addMethod("vaccineQuestion",function(){return $("input[name='flu_vaccine']:checked").val()?!0:!1},i18nJS_report_vaccination_status),$.validator.addMethod("extraVaccineQuestion",function(){return $("input[name='flu_vaccine_lastyr']:checked").val()?!0:!1},i18nJS_report_vaccination_status),$.validator.addMethod("suddenSymptoms",function(){return $("input:checkbox:checked.symptoms").length>0?$("input[name='acute']:checked").val()?!0:!1:!0},i18nJS_report_sudden_symptoms),$.validator.addMethod("wasTraveling",function(){return $("input:checkbox:checked.symptoms").length>0?$("input[name='traveling']:checked").val()?!0:!1:!0},i18nJS_report_travel_status),jQuery(".numbersOnly").keyup(function(){this.value=this.value.replace(/[^0-9]/g,"")})}};